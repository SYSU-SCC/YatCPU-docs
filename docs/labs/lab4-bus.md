# 总线

CPU 除了可以通过内存控制器访问内存以外，还可以通过总线协议访问外部设备。使用总线的目的是减少电路布线数量以及电路设计复杂度，避免 CPU 和外部设备之间直接连接。通过统一的总线抽象，CPU 可以使用总线协议访问外部设备，而不需要知道外部设备的硬件细节。具体的硬件操作则进一步抽象为读写硬件设备上的寄存器。

在本实验中，你将学习到：

- AXI4-Lite 总线协议原理
- 使用状态机实现总线协议
- 通过总线设置定时器开关以及触发间隔

## 


## 通过总线实现MMIO

我们在前面的实验中，在没有总线的情况下我们也实现了MMIO。因为我们的CPU此时只有一个访存读写接口（不算取指令的），并且也只有CPU有对这些外设的读写需求，所以通过简单的多路选择器就可以实现从CPU的访存单元到多个外设的内存映射了。

而本次实验中，我们实现了总线的读写功能了，那么我们可以把CPU的架构优化一下，每个需要与外设打交道的模块都可以作为独立的主机（master），而每个外设都作为独立的从机（slave）。

那么我们可以把IF取值单元的取值操作和MemoryAccess单元的访存操作都通过`AXI4LiteMaster`来接入总线来读写对应的外设。

我们把内存重新实现为只有一个读口的模型（没有单独的取指端口），并且通过`AXI4LiteSlave`来接上总线。

